{
  "id": "https://api.firecloud.org/schemas/library-attributedefinitions-v1",
  "$schema": "http://json-schema.org/draft-04/schema#",
  "title": "Library attribute definitions, v1",
  "description": "Constraints, facet definitions, and display definitions for FireCloud Library",
  "type": "object",
  "required": ["library:datasetName", "library:datasetVersion", "library:datasetDescription", "library:datasetCustodian",
    "library:datasetDepositor", "library:contactEmail", "library:datasetOwner", "library:institute", "library:indication",
    "library:numSubjects", "library:projectName", "library:dataCategory", "library:datatype", "library:dataUseRestriction",
    "library:studyDesign", "library:cellType", "library:requiresExternalApproval"],
  "oneOf": [{
    "required": ["library:GRU", "library:HMB", "library:NCU", "library:NPU", "library:NDMS", "library:NAGR",
      "library:NCTRL", "library:RS-G", "library:RS-PD"]
  }, {
    "required": ["library:orsp"]
  }],
  "properties": {
    "library:datasetName": {
      "title": "Cohort Name",
      "type": "string"
    },
    "library:datasetVersion": {
      "title": "Dataset Version",
      "type": "string"
    },
    "library:datasetDescription": {
      "title": "Cohort Description",
      "type": "string"
    },
    "library:datasetCustodian": {
      "title": "Dataset Custodian",
      "type": "string"
    },
    "library:datasetDepositor": {
      "title": "Dataset Depositor",
      "type": "string"
    },
    "library:contactEmail": {
      "title": "Contact Email",
      "type": "string"
    },
    "library:datasetOwner": {
      "title": "Dataset Owner",
      "type": "string"
    },
    "library:institute": {
      "title": "Research Institute",
      "type": "array",
      "items": { "type": "string" }
    },
    "library:indication": {
      "title": "Cohort Phenotype/Indication",
      "type": "string",
      "aggregate": {
        "renderHint": "checkbox"
      },
      "typeahead": "ontology",
      "relatedID": "library:diseaseOntologyID",
      "relatedLabel": "library:diseaseOntologyLabel"
    },
    "library:diseaseOntologyID": {
      "title": "Disease Ontology ID",
      "type": "string"
    },
    "library:diseaseOntologyLabel": {
      "type": "string",
      "title": "Cohort Phenotype/Indication (Disease Ontology)"
    },
    "library:numSubjects": {
      "title": "No. of Subjects",
      "type": "integer",
      "minimum": 0,
      "default": 0
    },
    "library:projectName": {
      "title": "Project Name",
      "type": "string",
      "aggregate": {
        "renderHint": "checkbox"
      }
    },
    "library:dataCategory": {
      "title": "Data Category",
      "type": "array",
      "items": { "type": "string" }
    },
    "library:datatype": {
      "title": "Experimental Strategy",
      "type": "array",
      "items": { "type": "string" },
      "aggregate": {
        "renderHint": "checkbox"
      }
    },
    "library:reference": {
      "title": "Genome Reference Version",
      "type": "string"
    },
    "library:dataFileFormats": {
      "title": "Data File Formats",
      "type": "array",
      "items": { "type": "string" }
    },
    "library:technology": {
      "title": "Profiling Instrument Type",
      "type": "array",
      "items": { "type": "string" }
    },
    "library:profilingProtocol": {
      "title": "Profiling Protocol",
      "type": "array",
      "items": { "type": "string" }
    },
    "library:dataUseRestriction": {
      "title": "Data Use Restriction",
      "type": "string",
      "aggregate": {
        "renderHint": "checkbox"
      }
    },
    "library:studyDesign": {
      "title": "Study Design",
      "type": "string"
    },
    "library:cellType": {
      "title": "Cell Type",
      "type": "string"
    },
    "library:coverage": {
      "title": "Depth of Sequencing Coverage (Average)",
      "type": "string",
      "enum": ["0-10X","11x-20x","21x-30x","31x-100x","100x-150x",">150x"]
    },
    "library:ethnicity": {
      "title": "Reported Ethnicity",
      "type": "array",
      "items": { "type": "string" }
    },
    "library:cohortCountry": {
      "title": "Cohort Country of Origin",
      "type": "string"
    },
    "library:requiresExternalApproval": {
      "title": "Requires External Approval",
      "type": "string",
      "enum": ["Yes", "No"],
      "default": "No"
    },
    "library:primaryDiseaseSite": {
      "title": "Primary Disease Site",
      "type": "string"
    },
    "library:GRU": {
      "title": "Data is available for future general research use",
      "type": "string",
      "enum": ["Yes", "No"],
      "consentCode": "GRU"
    },
    "library:HMB": {
      "title": "Future use is limited for health/medical/biomedical research",
      "type": "string",
      "enum": ["Yes", "No"],
      "consentCode": "HMB"
    },
    "library:DS": {
      "title": "Future use is limited to research involving the following disease area(s)",
      "type": "array",
      "items": { "type": "string" },
      "consentCode": "DS"
    },
    "library:NCU": {
      "title": "Future commercial use is prohibited",
      "type": "string",
      "enum": ["Yes", "No"],
      "consentCode": "NCU"
    },
    "library:NPU": {
      "title": "Future use by for-profit entities is prohibited",
      "type": "string",
      "enum": ["Yes", "No"],
      "consentCode": "NPU"
    },
    "library:NDMS": {
      "title": "Future use for methods research (analytic/software/technology development) outside the bounds of the other specified restrictions is prohibited",
      "type": "string",
      "enum": ["Yes", "No"],
      "consentCode": "NDMS"
    },
    "library:NAGR": {
      "title": "Future use of aggregate-level data for general research purposes is prohibited",
      "type": "string",
      "enum": ["Yes", "No", "Unspecified"],
      "consentCode": "NAGR"
    },
    "library:NCTRL": {
      "title": "Future use as a control set for diseases other than those specified is prohibited",
      "type": "string",
      "enum": ["Yes", "No"],
      "consentCode": "NCTRL"
    },
    "library:RS-G": {
      "title": "Future use is limited to research involving a particular gender",
      "type": "string",
      "enum": ["Male", "Female", "N/A"],
      "consentCode": "RS-G"
    },
    "library:RS-PD": {
      "title": "Future use is limited to pediatric research",
      "type": "string",
      "enum": ["Yes", "No"],
      "consentCode": "RS-PD"
    },
    "library:RS-POP": {
      "title": "Future use is limited to research involving a specific population",
      "type": "array",
      "items": { "type": "string" },
      "consentCode": "RS-POP"
    },
    "library:futureUseDate": {
      "title": "Future use is limited to data generated from samples collected after the following consent form date",
      "type": "string"
    },
    "library:orsp": {
      "type": "string"
    },
    "library:lmsvn": {
      "title": "Library Metadata Schema Version Number",
      "description": "Library Metadata Schema Version Number",
      "default": 3,
      "indexable": false,
      "type": "integer"
    },
    "library:dulvn": {
      "title": "Structured Data Use Limitations  Version Number",
      "description": "Structured Data Use Limitations Version Number",
      "default": 1,
      "indexable": false,
      "type": "integer"
    }
  },
  "consentCodes": {
    "GRU": "For health/medical/biomedical purposes and other biological research, including the study of population origins or ancestry.",
    "HMB": "Use of the data is limited to health/medical/biomedical purposes, does not include the study of population origins or ancestry.",
    "DS": "Use of the data must be related to a particular disease.",
    "NCU": "Use of the data is limited to non-commercial use.",
    "NPU": "Use of the data is limited to not-for-profit organizations.",
    "NDMS": "Use of the data includes methods development research (e.g., development of software or algorithms) ONLY within the bounds of other specified data use limitations.",
    "NAGR": "Use of the data includes aggregate level analysis to address research questions (e.g., determine variant frequencies across the general population) ONLY within the bounds of other specified data use limitations.",
    "NCTRL": "Data can be used as a control set ONLY within the bounds of other specified data use limitations (e.g. only for cancer studies).",
    "RS-G": "Use of the data is limited to studies of particular gender.",
    "RS-PD": "Use of the data is limited to pediatric research.",
    "RS-POP": "Use of the data is limited to studies of particular population."
  },
  "display": {
    "primary": ["library:diseaseOntologyLabel", "library:numSubjects", "library:dataCategory", "library:datatype", "library:dataUseRestriction"],
    "secondary": ["library:indication", "library:datasetName", "library:datasetVersion", "library:datasetDescription", "library:datasetOwner",
      "library:datasetCustodian", "library:datasetDepositor", "library:contactEmail", "library:institute", "library:primaryDiseaseSite",
      "library:projectName", "library:reference", "library:dataFileFormats", "library:technology", "library:profilingProtocol",
      "library:coverage", "library:studyDesign", "library:cellType", "library:ethnicity", "library:cohortCountry", "library:requiresExternalApproval",
      "library:lmsvn", "library:dulvn" ],
    "consentCodes": ["GRU", "HMB", "DS", "NCU", "NPU", "NDMS", "NAGR", "NCTRL", "RS-G", "RS-PD", "RS-POP"]
  },
  "wizard":
  [
    {
      "title": "Define Data Set attributes",
      "questions":
      [
        {"property": "library:datasetName", "required": true},
        {"property": "library:datasetVersion", "required": true},
        {"property": "library:datasetDescription", "required": true},
        {"property": "library:datasetOwner", "inputHint": "e.g. Prinicipal Investigator", "required": true},
        {"property": "library:datasetCustodian", "inputHint": "e.g. Project Manager", "required": true},
        {"property": "library:datasetDepositor", "inputHint": "e.g. Project Manager", "required": true},
        {"property": "library:contactEmail", "required": true, "renderHint": "email"},
        {"property": "library:institute", "required": true},
        {"property": "library:diseaseOntologyLabel", "hidden": true},
        {"property": "library:diseaseOntologyID", "hidden": true},
        {"property": "library:indication", "required": true},
        {"property": "library:primaryDiseaseSite"},
        {"property": "library:numSubjects", "inputHint": "Number of participants the data maps to", "required": true},
        {"property": "library:projectName", "inputHint": "e.g. TCGA, TopMed, ExAC ; tag all relevant associated projects", "required": true},
        {"property": "library:dataCategory", "inputHint": "e.g. Simple Nucleotide Variation (SNVs), Raw Sequencing data, Copy Number Variation, Structural Variation, Expression Quantification, Transcriptome Assembly, DNA-Methylation, Clinical phenotypes, Biospecimen metadata", "required": true},
        {"property": "library:datatype", "inputHint": "e.g. Whole Exome, Whole Genome, Exome Panel, Genotyping Array, RNA-Seq, Methylation Array; include all relevant", "required": true},
        {"property": "library:reference", "inputHint": "e.g. GRCh37/hg19, GRCh38/hg38; To which genome build the data was aligned, if relevant"},
        {"property": "library:dataFileFormats", "inputHint": "e.g. VCF, BAM, TXT, TSV, BCR XML, BED, GTF, GCT; Tag all relevant"},
        {"property": "library:technology", "inputHint": "e.g. Illumina, 10X"},
        {"property": "library:profilingProtocol"},
        {"property": "library:coverage"},
        {"property": "library:dataUseRestriction", "required": true},
        {"property": "library:studyDesign", "inputHint": "e.g. Case/Control, Tumor/Normal, Trio/Twin/Family, Prospective Longitudinal Cohort, Cases only - somatic, Cases only - germline, Controls", "required": true},
        {"property": "library:cellType", "required": true},
        {"property": "library:ethnicity", "inputHint": "e.g. Caucasians, African-Americans, Latino, East Asians, South Asians, Finnish, Non-Finnish Europeans; include all relevant"},
        {"property": "library:cohortCountry"},
        {"property": "library:requiresExternalApproval", "inputHint": "i.e. approval from a second source is required in order to access the data", "required": true}
      ]
    },
    {
      "title": "Catalog structured Data Use Restrictions",
      "switch": {
        "title": "Choose one of the available options to define Data Use Restrictions:",
        "options":
        [
          {
            "title": "Set Data Use Restrictions by answering a questionnaire",
            "enumerate": true,
            "questions":
            [
              {"property": "library:GRU", "required": true},
              {"property": "library:HMB", "required": true},
              {"property": "library:DS"},
              {"property": "library:NCU", "required": true},
              {"property": "library:NPU", "required": true},
              {"property": "library:NDMS", "required": true},
              {"property": "library:NAGR", "required": true},
              {"property": "library:NCTRL", "required": true},
              {"property": "library:RS-G", "required": true},
              {"property": "library:RS-PD", "required": true},
              {"property": "library:RS-POP"},
              {"property": "library:futureUseDate", "renderHint": "date"}
            ]
          },
          {
            "title": "Retrieve Data Use Restrictions from Broad ORSP",
            "questions":
            [
              {"property": "library:orsp", "required": true, "renderHint": "text"}
            ]
          }
        ]
      }
    }
  ],
  "versions": [
    "library:dulvn",
    "library:lmsvn"
  ],
  "searchResultColumns":
  [
    "library:datasetName",
    "library:indication",
    "library:dataUseRestriction",
    "library:numSubjects",
    "library:datasetVersion",
    "library:datasetDescription",
    "library:datasetOwner",
    "library:datasetCustodian",
    "library:datasetDepositor",
    "library:contactEmail",
    "library:institute",
    "library:diseaseOntologyLabel",
    "library:diseaseOntologyID",
    "library:studyDesign",
    "library:primaryDiseaseSite",
    "library:projectName",
    "library:dataCategory",
    "library:datatype",
    "library:reference",
    "library:dataFileFormats",
    "library:technology",
    "library:profilingProtocol",
    "library:coverage",
    "library:cellType",
    "library:ethnicity",
    "library:cohortCountry"
  ]
}
