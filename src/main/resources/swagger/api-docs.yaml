swagger: '2.0'

info:
  title: FireCloud
  description: |
    Genome analysis execution service.
  version: "0.0.1"
  license:
    name: BSD
    url: http://opensource.org/licenses/BSD-3-Clause
  termsOfService: https://github.com/broadinstitute/firecloud-orchestration

basePath: /

paths:
  /api/workspaces:
    get:
      tags:
      - Workspaces
      operationId: listWorkspaces
      summary: |
        Lists workspaces.
      produces:
      - application/json
      - text/plain
      responses:
        200:
          description: List of workspaces.
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
    post:
      tags:
        - Workspaces
      operationId: createWorkspace
      summary: Create workspace
      produces:
        - application/json
      parameters:
        - name: workspace
          description: New workspace information
          required: true
          type: string
          in: body
          schema:
            $ref: '#/definitions/WorkspaceIngest'
      responses:
        200:
          description: No response was specified
        201:
          description: Successful Request
        403:
          description: Unable to create bucket for workspace
        409:
          description: Workspace by that name already exists
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/methods:
    get:
      tags:
      - Method Repository
      operationId: listMethodRepositoryMethods
      summary: |
        Lists Method Repository methods.
      produces:
      - application/json
      responses:
        200:
          description: List of Method Repository methods.
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/configurations:
    get:
      tags:
      - Method Repository
      operationId: listMethodRepositoryConfigurations
      summary: |
        List Method Repository configurations.
      produces:
      - application/json
      responses:
        200:
          description: List of Method Repository configurations.
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/template:
    post:
      tags:
        - Method Repository
      operationId: createMethodTemplate
      summary: Create a Method Configuration template from a Method
      produces:
        - application/json
      parameters:
        - name: methodName
          description: name of Method to use for template
          required: true
          type: string
          in: body
          schema:
            $ref: '#/definitions/MethodID'
      responses:
        200:
          description: Method Configuration template
        400:
          description: Method WDL can't be parsed
        404:
          description: No Such Method
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/inputsOutputs:
    post:
      tags:
        - Method Repository
      operationId: getMethodIO
      summary: Get information about a method's inputs and outputs
      produces:
        - application/json
      parameters:
        - name: methodName
          description: name of Method to look up
          required: true
          type: string
          in: body
          schema:
            $ref: '#/definitions/MethodID'
      responses:
        200:
          description: Method Configuration inputs and outputs
        400:
          description: Method WDL can't be parsed
        404:
          description: No Such Method
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/configurations/{namespace}/{name}/{snapshotId}:
    get:
      tags:
        - Method Repository
      operationId: getMethodRepositoryConfiguration
      summary: Get a Method Repository configuration
      produces:
        - application/json
      parameters:
        - name: namespace
          description: Method Configuration namespace
          required: true
          type: string
          in: path
        - name: name
          description: Method Configuration name
          required: true
          type: string
          in: path
        - name: snapshotId
          description: Method Configuration snapshot ID
          required: true
          type: string
          in: path
      responses:
        200:
          description: Method Repository configuration detail
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/methods/{namespace}/{name}/{snapshotId}/permissions:
    get:
      tags:
        - Method Repository
      operationId: getMethodACL
      summary: get ACL permissions on a Method Repository method
      produces:
        - application/json
      parameters:
        - name: namespace
          description: Method namespace
          required: true
          type: string
          in: path
        - name: name
          description: Method name
          required: true
          type: string
          in: path
        - name: snapshotId
          description: Method snapshot ID
          required: true
          type: string
          in: path
      responses:
        200:
          description: the indicated method ACL
          schema:
            $ref: '#/definitions/MethodConfigACL'
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
    post:
      tags:
        - Method Repository
      operationId: setMethodACL
      summary: set ACL permissions on a Method Repository method
      produces:
        - application/json
      parameters:
        - name: namespace
          description: Method namespace
          required: true
          type: string
          in: path
        - name: name
          description: Method name
          required: true
          type: string
          in: path
        - name: snapshotId
          description: Method snapshot ID
          required: true
          type: string
          in: path
        - name: payload
          description: the ACLs to upsert
          required: true
          in: body
          schema:
            $ref: '#/definitions/MethodConfigACL'
      responses:
        200:
          description: the indicated method ACL once the posted changes have been applied
          schema:
            $ref: '#/definitions/MethodConfigACL'
        400:
          description: Bad Request
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/configurations/{namespace}/{name}/{snapshotId}/permissions:
    get:
      tags:
        - Method Repository
      operationId: getConfigACL
      summary: get ACL permissions on a Method Repository configuration
      produces:
        - application/json
      parameters:
        - name: namespace
          description: Method Configuration namespace
          required: true
          type: string
          in: path
        - name: name
          description: Method Configuration name
          required: true
          type: string
          in: path
        - name: snapshotId
          description: Method Configuration snapshot ID
          required: true
          type: string
          in: path
      responses:
        200:
          description: the indicated configuration ACL
          schema:
            $ref: '#/definitions/MethodConfigACL'
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
    post:
      tags:
        - Method Repository
      operationId: setConfigACL
      summary: set ACL permissions on a Method Repository configuration
      produces:
        - application/json
      parameters:
        - name: namespace
          description: Method Configuration namespace
          required: true
          type: string
          in: path
        - name: name
          description: Method Configuration name
          required: true
          type: string
          in: path
        - name: snapshotId
          description: Method Configuration snapshot ID
          required: true
          type: string
          in: path
        - name: payload
          description: the ACLs to upsert
          required: true
          in: body
          schema:
            $ref: '#/definitions/MethodConfigACL'
      responses:
        200:
          description: the indicated configuration ACL once the posted changes have been applied
          schema:
            $ref: '#/definitions/MethodConfigACL'
        400:
          description: Bad Request
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/workspaces/{workspaceNamespace}/{workspaceName}:
    get:
      tags:
        - Workspaces
      operationId: getWorkspace
      summary: Get workspace
      produces:
        - application/json
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
      responses:
        200:
          description: Successful Request
        404:
          description: Workspace does not exist
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
    delete:
      tags:
        - Workspaces
      operationId: deleteWorkspace
      summary: Delete workspace
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
      responses:
        202:
          description: Request Accepted
        404:
          description: Workspace does not exist
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/workspaces/{workspaceNamespace}/{workspaceName}/checkBucketReadAccess:
    get:
      description: Read a workspace bucket
      tags:
        - Workspaces
      summary: Read workspace bucket
      operationId: readBucket
      parameters:
        - in: path
          description: Workspace Namespace
          name: workspaceNamespace
          required: true
          type: string
        - in: path
          description: Workspace Name
          name: workspaceName
          required: true
          type: string
      responses:
        200:
          description: Successful Request
        403:
          description: Insufficient permissions to access workspace bucket
        404:
          description: Workspace Not Found
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/workspaces/{workspaceNamespace}/{workspaceName}/acl:
    get:
      tags:
        - Workspaces
      operationId: getWorkspaceAcl
      summary: Get workspace ACL
      produces:
        - application/json
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
      responses:
        200:
          description: Successful Request
        400:
          description: Can't retrieve ACL for workspace
        404:
          description: Workspace not found
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
    patch:
      tags:
        - Workspaces
      operationId: updateWorkspaceACL
      summary: Update workspace ACL
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
        - name: aclUpdates
          description: Series of ACL updates for workspace
          required: true
          type: List[Map[string, string]]
          in: body
      responses:
        200:
          description: Successful Request
        400:
          description: Can't set ACL for workspace
        404:
          description: Workspace not found
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/workspaces/{workspaceNamespace}/{workspaceName}/clone:
    post:
      tags:
        - Workspaces
      operationId: cloneWorkspace
      summary: Clone Workspace
      produces:
        - application/json
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
        - name: workspace
          description: Cloned workspace information
          required: true
          type: string
          in: body
          schema:
            $ref: '#/definitions/WorkspaceIngest'
      responses:
        201:
          description: Successful Request
        400:
          description: Unable to create resources for workspace
        404:
          description: Source workspace not found
        409:
          description: Destination workspace already exists
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/workspaces/{workspaceNamespace}/{workspaceName}/lock:
    put:
      tags:
        - Workspaces
      operationId: lockWorkspace
      summary: Lock Workspace
      produces:
        - application/json
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
      responses:
        200:
          description: No response was specified
        204:
          description: Successful Request
        403:
          description: Not Owner
        404:
          description: Workspace Not Found
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/workspaces/{workspaceNamespace}/{workspaceName}/unlock:
    put:
      tags:
        - Workspaces
      operationId: unlockWorkspace
      summary: Unlock Workspace
      produces:
        - application/json
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
      responses:
        200:
          description: No response was specified
        204:
          description: Successful Request
        403:
          description: Not Owner
        404:
          description: Workspace Not Found
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/workspaces/{workspaceNamespace}/{workspaceName}/entities_with_type:
    get:
      type: EntityWithType
      tags:
      - Entities
      operationId: getEntitiesWithType
      summary: |
        List of entities in a workspace with type and attribute information
      produces:
        - application/json
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
      responses:
        200:
          description: List of entities
        404:
          description: Workspace or entities not found.
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/workspaces/{workspaceNamespace}/{workspaceName}/entities:
    get:
      type: String
      tags:
      - Entities
      operationId: getEntityTypes
      summary: |
        List of entity types in a workspace
      produces:
        - application/json
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
      responses:
        200:
          description: List of entity types in workspace
        404:
          description: Workspace does not exist
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/workspaces/{workspaceNamespace}/{workspaceName}/importEntities:
    post:
      tags:
        - Entities
      operationId: importEntities
      summary: Import entities from a tsv file
      consumes:
        - multipart/form-data
      produces:
        - application/json
      parameters:
        - name: workspaceNamespace
          description: Destination Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Destination Workspace Name
          required: true
          type: string
          in: path
        - name: entities
          in: formData
          description: A valid TSV import file
          required: true
          type: file
      responses:
        200:
          description: Successful Request
        400:
          description: Bad Request
        404:
          description: Source Workspace not found
        500:
          description: Internal Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/workspaces/{workspaceNamespace}/{workspaceName}/entities/copy:
    post:
      tags:
      - Entities
      operationId: copyEntities
      summary: |
        Copy entities from one workspace to another
      produces:
        - application/json
      parameters:
        - name: workspaceNamespace
          description: Destination Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Destination Workspace Name
          required: true
          type: string
          in: path
        - name: body
          description: Entities to Copy
          required: true
          in: body
          schema:
            $ref: '#/definitions/CopyEntity'
      responses:
        200:
          description: No response was specified
        201:
          description: Successful Request
        404:
          description: Source Workspace or source entities does not exist
        409:
          description: One or more entities of that name/type already exist
        500:
          description: Internal Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
# Entity delete endpoint commented out until GAWB-422 is complete
#  /api/workspaces/{workspaceNamespace}/{workspaceName}/entities/delete:
#    post:
#      tags:
#      - Entities
#      operationId: deleteEntities
#      summary: Bulk delete entities from a workspace
#      produces:
#        - application/json
#      parameters:
#        - name: workspaceNamespace
#          description: Destination Workspace Namespace
#          required: true
#          type: string
#          in: path
#        - name: workspaceName
#          description: Destination Workspace Name
#          required: true
#          type: string
#          in: path
#        - name: body
#          description: Entities to delete
#          required: true
#          in: body
#          schema:
#            $ref: '#/definitions/DeleteEntities'
#      responses:
#        200:
#          description: Successful Request
#        400:
#          description: Malformed Request
#        500:
#          description: Internal Server Error
#      security:
#        - bearer:
#        - googleoauth:
#            - openid
#            - email
#            - profile
#            - https://www.googleapis.com/auth/devstorage.full_control
  /api/workspaces/{workspaceNamespace}/{workspaceName}/entities/{entityType}:
    get:
      type: Entity
      tags:
      - Entities
      operationId: getEntities
      summary: |
        List of entities in a workspace
      produces:
        - application/json
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
        - name: entityType
          description: Entity Type
          required: true
          type: string
          in: path
      responses:
        200:
          description: List of entities in workspace
        404:
          description: Workspace or entity type does not exist
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/workspaces/{workspaceNamespace}/{workspaceName}/entities/{entityType}/tsv:
    get:
      type: file
      tags:
      - Entities
      operationId: downloadEntitiesTSV
      summary: |
        TSV file containing workspace entities of the specified type
      produces:
        - text/plain
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
        - name: entityType
          description: Entity Type
          required: true
          type: string
          in: path
      responses:
        200:
          description: Workspace entities of specified type in TSV format
        404:
          description: Workspace or entity type does not exist
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/workspaces/{workspaceNamespace}/{workspaceName}/entities/{entityType}/{entityName}:
    get:
      tags:
        - Entities
      operationId: getEntity
      summary: Get entity in a workspace
      produces:
        - application/json
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
        - name: entityType
          description: Entity Type
          required: true
          type: string
          in: path
        - name: entityName
          description: Entity Name
          required: true
          type: string
          in: path
      responses:
        200:
          description: Success
        404:
          description: Workspace or Entity does not exist
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
# Entity delete endpoint commented out until GAWB-422 is complete
#    delete:
#      tags:
#        - Entities
#      operationId: deleteEntity
#      summary: Delete entity in a workspace
#      produces:
#        - application/json
#      parameters:
#        - name: workspaceNamespace
#          description: Workspace Namespace
#          required: true
#          type: string
#          in: path
#        - name: workspaceName
#          description: Workspace Name
#          required: true
#          type: string
#          in: path
#        - name: entityType
#          description: Entity Type
#          required: true
#          type: string
#          in: path
#        - name: entityName
#          description: Entity Name
#          required: true
#          type: string
#          in: path
#      responses:
#        200:
#          description: No response was specified
#        204:
#          description: Successful Request
#        404:
#          description: Workspace or Entity does not exist
#        500:
#          description: Internal Server Error
#      security:
#        - bearer:
#        - googleoauth:
#            - openid
#            - email
#            - profile
#            - https://www.googleapis.com/auth/devstorage.full_control
  /cookie-authed/workspaces/{workspaceNamespace}/{workspaceName}/entities/{entityType}/tsv:
    get:
      type: file
      tags:
      - Entities
      operationId: browserDownloadEntitiesTSV
      summary: |
        TSV file containing workspace entities of the specified type (allows cookie-based authentication)
      produces:
        - text/plain
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
        - name: entityType
          description: Entity Type
          required: true
          type: string
          in: path
      responses:
        200:
          description: Workspace entities of specified type in TSV format
        404:
          description: Workspace or entity type does not exist
        500:
          description: Internal Server Error
  /api/workspaces/{workspaceNamespace}/{workspaceName}/entityQuery/{entityType}:
    get:
      type: Entity
      tags:
        - Entities
      operationId: entityQuery
      summary: Paginated query for entities in a workspace
      produces:
        - application/json
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
        - name: entityType
          description: Entity Type
          required: true
          type: string
          in: path
        - name: page
          description: Page number, 1-indexed (default 1)
          default: 1
          minimum: 1
          type: number
          in: query
        - name: pageSize
          description: Page size (default 10)
          default: 10
          minimum: 1
          type: number
          in: query
        - name: sortField
          description: Sort field (default "name")
          default: name
          type: string
          in: query
        - name: sortDirection
          description: Sort direction (asc or desc, default asc)
          default: asc
          enum: ["asc","desc"]
          type: string
          in: query
        - name: filterTerms
          description: Filter terms
          type: string
          in: query
      responses:
        200:
          description: List of entities in workspace
          schema:
            $ref: '#/definitions/EntityQueryResponse'
        404:
          description: Workspace or entity type does not exist
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/workspaces/{workspaceNamespace}/{workspaceName}/methodconfigs:
    get:
      tags:
        - Method Configurations
        - Workspaces
      operationId: listWorkspaceMethodConfigs
      summary: List of Method Configurations in a workspace
      produces:
        - application/json
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
      responses:
        200:
          description: List of Method Configurations
        404:
          description: Workspace does not exist
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
    post:
      tags:
        - Method Configurations
        - Workspaces
      operationId: postWorkspaceMethodConfig
      summary: Create a Method Configuration in a workspace
      produces:
        - application/json
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
        - name: methodConfigJson
          description: Method Configuration contents
          required: true
          type: string
          in: body
          schema:
            $ref: '#/definitions/NewMethodConfigIngest'
      responses:
        201:
          description: Successful Request
        404:
          description: Workspace not found
        409:
          description: Method Configuration already exists
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/workspaces/{workspaceNamespace}/{workspaceName}/method_configs/{configNamespace}/{configName}:
    get:
      tags:
        - Method Configurations
      operationId: getWorkspaceMethodConfig
      summary: Get a method configuration in a workspace
      produces: application/json
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
        - name: configNamespace
          description: Configuration Namespace
          required: true
          type: string
          in: path
        - name: configName
          description: Configuration Name
          required: true
          type: string
          in: path
      responses:
        200:
          description: Successful
        404:
          description: Workspace or Method Configuration not found
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
    put:
      tags:
        - Method Configurations
      operationId: updateWorkspaceMethodConfig
      summary: Update a method configuration in a workspace
      produces: application/json
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
        - name: configNamespace
          description: Configuration Namespace
          required: true
          type: string
          in: path
        - name: configName
          description: Configuration Name
          required: true
          type: string
          in: path
        - name: body
          description: Method Config to Update
          required: true
          type: string
          in: body
          schema:
            $ref: '#/definitions/ConfigurationIngest'
      responses:
        200:
          description: Successful
        404:
          description: Workspace or Method Configuration not found
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
    delete:
      tags:
        - Method Configurations
      operationId: deleteWorkspaceMethodConfig
      summary: Delete a method configuration in a workspace
      produces: application/json
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
        - name: configNamespace
          description: Configuration Namespace
          required: true
          type: string
          in: path
        - name: configName
          description: Configuration Name
          required: true
          type: string
          in: path
      responses:
        200:
          description: Successful request
        404:
          description: Workspace or Method Configuration not found
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/workspaces/{workspaceNamespace}/{workspaceName}/methodconfigs/{configNamespace}/{configName}/validate:
    get:
      responses:
        '200':
          description: Successful Request
          schema:
            $ref: '#/definitions/ValidatedMethodConfiguration'
        '404':
          description: Workspace or Method Configuration does not exist
        '500':
          description: Rawls Internal Error
      description: ''
      tags:
        - Method Configurations
      summary: get syntax validation information for a method configuration
      operationId: validate_method_configuration
      parameters:
        - in: path
          description: Workspace Namespace
          name: workspaceNamespace
          required: true
          type: string
        - in: path
          description: Workspace Name
          name: workspaceName
          required: true
          type: string
        - in: path
          description: Method Configuration Namespace
          name: configNamespace
          required: true
          type: string
        - in: path
          description: Method Configuration Name
          name: configName
          required: true
          type: string
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/workspaces/{workspaceNamespace}/{workspaceName}/method_configs/{configNamespace}/{configName}/rename:
    post:
      tags:
        - Method Configurations
      operationId: renameWorkspaceMethodConfig
      summary: Rename a method configuration in a workspace
      produces: application/json
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
        - name: configNamespace
          description: Configuration Namespace
          required: true
          type: string
          in: path
        - name: configName
          description: Configuration Name
          required: true
          type: string
          in: path
        - name: rename
          description: Method Config Rename
          required: true
          type: string
          in: body
          schema:
            $ref: '#/definitions/MethodConfigRename'
      responses:
        204:
          description: Successful request
        404:
          description: Workspace or Method Configuration not found
        409:
          description: Method Configuration with that name already exists
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/workspaces/{workspaceNamespace}/{workspaceName}/method_configs/copyFromMethodRepo:
    post:
      tags:
        - Method Configurations
        - Method Repository
      operationId: copyFromMethodRepo
      summary: Copy a Method Repository Configuration into a workspace
      produces: application/json
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
        - name: configToCopy
          description: Method Configuration to Copy
          required: true
          type: string
          in: body
          schema:
            $ref: '#/definitions/CopyConfigurationIngest'
      responses:
        201:
          description: Successful request
        404:
          description: Source method configuration does not exist
        409:
          description: Destination method configuration by that name already exists
        422:
          description: Error parsing source method configuration
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/workspaces/{workspaceNamespace}/{workspaceName}/method_configs/copyToMethodRepo:
    post:
      tags:
        - Method Configurations
        - Method Repository
      operationId: copyToMethodRepo
      summary: Copy a Method Config in a workspace to the Method Repository
      produces: application/json
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
        - name: configToCopy
          description: Method Configuration to Copy
          required: true
          type: string
          in: body
          schema:
            $ref: '#/definitions/PublishConfigurationIngest'
      responses:
        201:
          description: Successful request
        404:
          description: Source method configuration does not exist
        409:
          description: Destination method configuration by that name already exists
        422:
          description: Error parsing source method configuration
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/workspaces/{workspaceNamespace}/{workspaceName}/submissions:
    get:
      tags:
      - Submissions
      operationId: listSubmissions
      summary: |
        List submissions.
      produces:
      - application/json
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
      responses:
        200:
          description: List of submissions
        404:
          description: Workspace not found
        500:
          description: Internal Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
    post:
      tags:
      - Submissions
      operationId: createSubmission
      summary: |
        Create a submission.
      produces:
      - application/json
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
        - name: submission
          description: Post Submission
          required: true
          type: string
          in: body
          schema:
            $ref: '#/definitions/SubmissionIngest'
      responses:
        201:
          description: Successful Request
        400:
          description: Expression eval failed or entities are not of type required by method config
        404:
          description: Method Configuration or Entity not found
        409:
          description: Method Configuration failed to resolve input expressions with the supplied Entity
        500:
          description: Internal Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/workspaces/{workspaceNamespace}/{workspaceName}/submissions/{submissionId}:
    delete:
      tags:
      - Submissions
      operationId: deleteSubmission
      summary: |
        abort a submission
      produces:
      - application/json
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
        - name: submissionId
          description: Submission ID
          required: true
          type: string
          in: path
      responses:
        204:
          description: successful deletion
        404:
          description: Submission not found
        500:
          description: Internal Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
    get:
      tags:
      - Submissions
      operationId: monitorSubmission
      summary: |
        Monitor submission status
      produces:
      - application/json
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
        - name: submissionId
          description: Submission ID
          required: true
          type: string
          in: path
      responses:
        200:
          description: monitor a submission status
        404:
          description: Submission not found
        500:
          description: Internal Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/workspaces/{workspaceNamespace}/{workspaceName}/submissions/{submissionId}/workflows/{workflowId}/outputs:
    get:
      tags:
      - Submissions
      operationId: workflowOutputsInSubmission
      summary: |
        Get workflow outputs.
      produces:
      - application/json
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
        - name: submissionId
          description: Submission ID
          required: true
          type: string
          in: path
        - name: workflowId
          description: Workflow ID
          required: true
          type: string
          in: path
      responses:
        200:
          description: Get workflow outputs
        404:
          description: Submission or Workflow not found
        500:
          description: Internal Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/submissions/queueStatus:
    get:
      responses:
        '200':
          description: Successful Request
        '500':
          description: Internal Error
      description: List workflow counts by queueing state
      tags:
        - Submissions
      summary: workflow queue status
      operationId: workflowQueueStatus
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/workspaces/{workspaceNamespace}/{workspaceName}/updateAttributes:
    patch:
      tags:
      - Workspaces
      operationId: updateAttributes
      summary: |
        Modify attributes on a workspace.
      produces:
      - application/json
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
        - name: workspaceUpdateJson
          description: Attribute operations
          required: true
          type: array
          items:
            $ref: '#/definitions/AttributeUpdateOperation'
          in: body
      responses:
        200:
          description: Success
        400:
          description: Invalid operation
        404:
          description: Workspace not found
        500:
          description: Internal Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/status:
    get:
      tags:
      - Status
      operationId: status
      summary: |
        Returns the workspace service url, methods repository url, and the current timestamp.
      produces:
      - application/json
      parameters:
      responses:
        200:
          description: Success
        500:
          description: Internal Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
        - bearer:
  /api/status/ping:
    get:
      tags:
      - Status
      operationId: ping
      summary: |
        Returns the current timestamp.
      produces:
      - text/plain
      parameters:
      responses:
        200:
          description: Success
        500:
          description: Internal Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
        - bearer:
  /health:
    get:
      tags:
      - Status
      operationId: health
      summary: |
        A health status endpoint for load balancing purposes
      responses:
        200:
          description: Success
  /error:
    get:
      tags:
      - Status
      operationId: error
      summary: |
        An error status endpoint for load balancing purposes
      responses:
        503:
          description: Service Unavailable
  /api/storage/{bucket}/{object}:
    get:
      tags:
      - Storage
      operationId: getMetadata
      summary: |
        Get metadata about an object stored in GCS.
      description: |
        Mirror of Google's Cloud Storage json API. See https://cloud.google.com/storage/docs/json_api/v1/objects/get
      produces:
      - application/json
      parameters:
        - name: bucket
          description: Name of the bucket in which the object resides.
          required: true
          type: string
          in: path
        - name: object
          description: Name of the object. (be sure to urlencode)
          required: true
          type: string
          in: path
      responses:
        200:
          description: Success
        404:
          description: Not Found
        500:
          description: Internal Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /me:
    get:
      tags:
        - Profile
      operationId: me
      summary: Returns registration and activation status for the current user
      responses:
        200:
          description: OK
          produces:
          - application/json
          schema:
            $ref: '#/definitions/Me'
        401:
          description: Unauthorized. User is not allowed in FireCloud or has not signed in.
        403:
          description: Forbidden. User is registered in FireCloud, but not activated.
        404:
          description: Not Found. User is authenticated to Google but not a FireCloud member.
        500:
          description: Internal Server Error determining user status.
        503:
          description: Service Unavailable. Could not reach underlying services to determine user status.
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /register:
    get:
      tags:
        - Profile
      operationId: getUserStatus
      summary: Passes through to the Rawls userinfo API and returns its response
      responses:
        200:
          description: OK
          produces:
          - application/json
          schema:
            $ref: '#/definitions/RawlsMe'
        404:
          description: User Not Found.
        500:
          description: Internal Server Error determining Rawls user status.
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /register/profile:
    get:
      tags:
        - Profile
      operationId: getAll
      summary: Returns a list of all keys and values stored in the user profile service for the currently logged-in user.
      parameters:
      responses:
        200:
          description: OK
          produces:
          - application/json
          schema:
            {
              "properties": {
                "userId": {
                  type: "string"
                },
                "keyValuePairs": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "required": [ "key", "value" ],
                    "properties": {
                      "key": {
                        "type": "string"
                      },
                      "value": {
                        "type": "string"
                      }
                    }
                  }
                }
              },
              "type": "object",
              "required": [ "userId", "keyValuePairs" ]
            }
        500:
          description: Internal server error
          produces: text/plain
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
    post:
      tags:
        - Profile
      operationId: setProfile
      summary: Sets a profile object in the user profile service for the currently logged-in user.
      consumes:
      - application/json
      parameters:
      - name: profile
        description: A complete profile
        type: string
        in: body
        schema:
          $ref: '#/definitions/Profile'
      responses:
        200:
          description: OK
        400:
          description: Bad request
        500:
          description: Internal server error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /register/userinfo:
    get:
      tags:
        - Profile
      operationId: userInfo
      summary: Passes through to Google's userinfo API and returns its response
      description: See https://developers.google.com/+/web/api/rest/openidconnect/getOpenIdConnect for response info.
        Userinfo endpoint lives at https://www.googleapis.com/oauth2/v3/userinfo.
      responses:
        200:
          description: OK
          produces:
          - application/json
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  '/api/library/user/role/curator':
    get:
      responses:
        '200':
          schema: {"properties": {"curator": {type: "boolean"}}}
        '500':
          description: Rawls Internal Error
          schema:
            $ref: '#/definitions/ErrorReport'
      description: "gets the curator status of a user"
      tags:
        - Profile
      summary: Query to see if you're a library curator
      operationId: isCurator
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  '/api/library/{workspaceNamespace}/{workspaceName}/metadata':
    put:
      tags:
        - Library
      operationId: putLibraryMetadata
      summary: |
        put the entire metadata for a library dataset
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
        - name: workspaceUpdateJson
          description: Attribute operations
          required: true
          type: object
          in: body
      responses:
        200:
          description: Success
          schema:
            $ref: '#/definitions/Workspace'
        500:
          description: Rawls Internal Error
          schema:
            $ref: '#/definitions/ErrorReport'
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  '/api/library/{workspaceNamespace}/{workspaceName}/published':
    post:
      tags:
        - Library
      operationId: publishLibraryWorkspace
      summary: |
        publish the workspace in the Library
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
      responses:
        200:
          description: Success
          schema:
            $ref: '#/definitions/Workspace'
        403:
          description: You must be the workspace owner and library curator to publish a workspace to the library
        500:
          description: Rawls Internal Error
          schema:
            $ref: '#/definitions/ErrorReport'
      security:
        - bearer:
        - googleoauth:
          - openid
          - email
          - profile
          - https://www.googleapis.com/auth/devstorage.full_control
    delete:
      tags:
        - Library
      operationId: unpublishLibraryWorkspace
      summary: |
        unpublish the workspace in the Library
      parameters:
        - name: workspaceNamespace
          description: Workspace Namespace
          required: true
          type: string
          in: path
        - name: workspaceName
          description: Workspace Name
          required: true
          type: string
          in: path
      responses:
        200:
          description: Success
          schema:
            $ref: '#/definitions/Workspace'
        403:
          description: You must be the workspace owner and library curator to unpublish a workspace from the library
        500:
          description: Rawls Internal Error
          schema:
            $ref: '#/definitions/ErrorReport'
      security:
        - bearer:
        - googleoauth:
          - openid
          - email
          - profile
          - https://www.googleapis.com/auth/devstorage.full_control
  '/api/library/admin/reindex':
    post:
      tags:
        - Library
      operationId: reindexAll
      summary: |
        deletes and rebuilds the entire index of published library datasets
      responses:
        200:
          description: Success
        500:
          description: Rawls Internal Error
          schema:
            $ref: '#/definitions/ErrorReport'
      security:
        - bearer:
        - googleoauth:
          - openid
          - email
          - profile
          - https://www.googleapis.com/auth/devstorage.full_control

### GAWB-934 we're hiding billing endpoints for now
#  /api/billing:
#    post:
#      responses:
#        '204':
#          description: Successfully Created Billing Project in FireCloud and Google
#        '400':
#          description: firecloud billing user must be an administrator of the billing account
#        '403':
#          description: You must be an administrator of the google billing account
#        '409':
#          description: project already exists in firecloud or google
#        '500':
#          description: Rawls Internal Error
#      description: create new billing project in firecloud and google
#      parameters:
#        - in: body
#          description: create project request
#          name: createProjectRequest
#          required: true
#          schema:
#            $ref: '#/definitions/CreateRawlsBillingProjectFullRequest'
#      tags:
#        - Billing
#      summary: create billing project in firecloud and google
#      operationId: createBillingProjectFull
#      security:
#        - bearer:
#        - googleoauth:
#            - openid
#            - email
#            - profile
#            - https://www.googleapis.com/auth/cloud-billing
#  '/api/billing/{projectId}/members':
#    get:
#      responses:
#        '200':
#          description: Success
#          schema:
#            type: array
#            items:
#              $ref: '#/definitions/BillingProjectMember'
#        '403':
#          description: You must be a project owner to view the members of a project
#        '500':
#          description: Rawls Internal Error
#      description: list members of billing project the caller owns
#      parameters:
#        - in: path
#          description: Project ID
#          name: projectId
#          required: true
#          type: string
#      tags:
#        - Billing
#      summary: list members of billing project the caller owns
#      operationId: listBillingProjectMembers
#      security:
#        - bearer:
#        - googleoauth:
#            - openid
#            - email
#            - profile
#  '/api/billing/{projectId}/{role}/{userEmail}':
#    put:
#      responses:
#        '200':
#          description: Successfully Added User To Billing Project
#        '403':
#          description: You must be a project owner to add a user to a billing project
#        '404':
#          description: User not found
#        '500':
#          description: Rawls Internal Error
#      description: add user to billing project the caller owns
#      parameters:
#        - in: path
#          description: Project ID
#          name: projectId
#          required: true
#          type: string
#        - in: path
#          description: role of user for project
#          name: role
#          required: true
#          type: string
#          enum: ["user", "owner"]
#        - in: path
#          description: User Email
#          name: userEmail
#          required: true
#          type: string
#      tags:
#        - Billing
#      summary: add user to billing project the caller owns
#      operationId: addUserToBillingProject
#      security:
#        - bearer:
#        - googleoauth:
#            - openid
#            - email
#            - profile
#    delete:
#      responses:
#        '200':
#          description: Successfully Removed User From Billing Project
#        '403':
#          description: You must be a project owner to add a user to a billing project
#        '404':
#          description: User not found
#        '500':
#          description: Rawls Internal Error
#      description: remove user from billing project the caller owns
#      parameters:
#        - in: path
#          description: Project ID
#          name: projectId
#          required: true
#          type: string
#        - in: path
#          description: role of user for project
#          name: role
#          required: true
#          type: string
#          enum: ["user", "owner"]
#        - in: path
#          description: User Email
#          name: userEmail
#          required: true
#          type: string
#      tags:
#        - Billing
#      summary: remove user from billing project the caller owns
#      operationId: removeUserFromBillingProject
#      security:
#        - bearer:
#        - googleoauth:
#            - openid
#            - email
#            - profile
  /api/profile/billing:
    get:
      tags:
        - Profile
      operationId: billing
      summary: List billing projects for a user
      responses:
        200:
          description: OK
          produces:
          - application/json
          schema:
            type: array
            items:
              $ref: '#/definitions/BillingProjectMembership'
        404:
          description: User Not Found
        500:
          description: Internal Server Error
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
#  /api/profile/billingAccounts:
#    get:
#      tags:
#        - Profile
#      operationId: billingAccounts
#      summary: List billing accounts for a user
#      responses:
#        200:
#          description: OK
#          produces:
#          - application/json
#          schema:
#            type: array
#            items:
#              $ref: '#/definitions/BillingAccount'
#        403:
#          description: Forbidden - redirect to Google to enable appropriate scopes
#          produces:
#          - application/json
#          schema:
#            $ref: '#/definitions/BillingAccountRedirect'
#        500:
#          description: Internal Server Error
#      security:
#        - bearer:
#        - googleoauth:
#            - openid
#            - email
#            - profile
#            - https://www.googleapis.com/auth/devstorage.full_control
#            - https://www.googleapis.com/auth/cloud-billing



  /login:
    get:
      tags:
        - OAuth
      operationId: login
      summary: Starts the authentication flow for a user
      description: This is an unauthenticated endpoint at /login (not /api/login) that initiates the OAuth flow.
        Authentication cannot be initiated from within swagger, because auth requires the entire browser
        to redirect, and swagger uses ajax. To test, fill in your desired query params, then copy and paste the
        request url into your browser address bar.
      parameters:
      - name: path
        in: query
        description: The url fragment to use after finishing authentication
        required: false
        type: string
      - name: prompt
        in: query
        description: use "force" to always request a new refresh token
        required: false
        type: string
        enum: ["auto","force"]
        default: "auto"
      - name: callback
        in: query
        description: The host to use after finishing authentication. Include the scheme, but no trailing slash, e.g. https://firecloud.broadinstitute.org
        required: false
        type: string
      responses:
        307:
          description: Successful redirect after authentication
        401:
          description: Unauthorized
        500:
          description: Internal server error
  /api/nih/callback:
    post:
      tags:
        - NIH
      operationId: NIHCallback
      summary: Updates a user's NIH link from a JWT
      parameters:
        - name: jwt
          description: JWT from NIH login
          required: true
          type: string
          in: body
          schema:
            $ref: '#/definitions/JWTWrapper'
      responses:
        200:
          description: Successfully updated NIH link
        400:
          description: Invalid or malformed JWT
        401:
          description: Unauthorized
        500:
          description: Internal server error saving NIH link to profile
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /api/nih/status:
    get:
      tags:
        - NIH
      operationId: NIHStatus
      summary: "Retrieves info about a user's NIH link"
      parameters:
      responses:
        200:
          description: Successfully retrieved NIH status
          produces:
            - application/json
          schema:
            $ref: '#/definitions/NIHStatus'
        204:
          description: isDbgapAuthorized key missing from status
        404:
          description: linkedNihUsername key missing from status
        500:
          description: Internal server error retrieving NIH status
      security:
        - bearer:
        - googleoauth:
            - openid
            - email
            - profile
            - https://www.googleapis.com/auth/devstorage.full_control
  /sync_whitelist:
    post:
      tags:
        - NIH
      operationId: NIHSyncWhitelist
      summary: Downloads the NIH Whitelist and Updates Rawls groups approrpriately
      responses:
        204:
          description: Successfully synced NIH whitelist
        500:
          description: Internal server error syncing NIH whitelist
securityDefinitions:
  googleoauth:
    type: oauth2
    authorizationUrl: 'https://accounts.google.com/o/oauth2/auth'
    flow: implicit
    scopes:
      openid: open id authorization
      email: email authorization
      profile: profile authorization
      https://www.googleapis.com/auth/devstorage.full_control: GCS storage
      https://www.googleapis.com/auth/cloud-billing: GCS billing
  bearer:
    type: apiKey
    name: Authorization
    in: header
definitions:
  WorkspaceIngest:
    required:
      - namespace
      - name
      - attributes
    properties:
      namespace:
        type: string
        description: New workspace namespace
      name:
        type: string
        description: New workspace name
      attributes:
        type: object
        additionalProperties:
          type: string
        description: Map of attributes
      isProtected:
        type: boolean
        description: Whether or not the data should be restricted to dbGaP-enabled users.  Optional, default false.
  MethodConfigACL:
    type: array
    items:
      properties:
        user:
          type: string
          description: a user's ID or "public"
        role:
          type: string
          description: one of "NO ACCESS", "READER", or "OWNER"
      required:
        - userId
        - accessLevel
  SubmissionIngest:
    properties:
      methodConfigurationNamespace:
        type: string
        description: Namespace of the method configuration to execute.
      methodConfigurationName:
        type: string
        description: Name of the method configuration to execute.
      entityType:
        type: string
        description: Type of root entity for expression.
      entityName:
        type: string
        description: Name of root entity for expression.
      expression:
        type: string
        description: Expression that resolves to one or more entities matching the entity type
          in the method configuration. Leave blank for default.
    required:
      - methodConfigurationNamespace
      - methodConfigurationName
      - entityType
      - entityName
  ConfigurationIngest:
    properties:
      namespace:
        type: string
        description: Method configuration namespace
      name:
        type: string
        description: Method configuration name
      rootEntityType:
        type: string
        description: Root entity type
      workspaceName:
        type: Map[String, String]
        description: Map with corresponding workspace-related information - name and namespace
      methodRepoMethod:
        type: Map[String, String]
        description: Map with corresponding method-related information
      outputs:
        type: Map[String, String]
        description: Map with outputs information
      inputs:
        type: Map[String, String]
        description: Map with inputs information
      prerequisites:
        type: Map[String, String]
        description: Map of prerequisites (keys unused, will be removed in the future)
    required:
      - namespace
      - name
      - rootEntityType
      - workspaceName
      - methodRepoMethod
      - outputs
      - inputs
      - prerequisites
  MethodConfigRename:
    properties:
      namespace:
        type: string
        description: Method configuration namespace
      name:
        type: string
        description: Method configuration name
      workspaceName:
        type: Map[String, String]
        description: Map with corresponding workspace-related information - name and namespace
    required:
      - namespace
      - name
      - workspaceName
  CopyConfigurationIngest:
    properties:
      configurationNamespace:
        type: string
        description: Method configuration namespace
      configurationName:
        type: string
        description: Method configuration name
      configurationSnapshotId:
        type: string
        description: Method configuration snapshot id
      destinationNamespace:
        type: string
        description: Method configuration destination namespace
      destinationName:
        type: string
        description: Method configuration destination name
    required:
      - configurationNamespace
      - configurationName
      - configurationSnapshotId
      - destinationNamespace
      - destinationName
  NewMethodConfigIngest:
    properties:
      namespace:
        type: string
        description: Method configuration namespace
      name:
        type: string
        description: Method configuration name
      rootEntityType:
        type: string
        description: Method configuration root entity type
      inputs:
        type: Map[string, string]
        description: Input map
      outputs:
        type: Map[string, string]
        description: Output map
      prerequisites:
        type: Map[string, string]
        description: Prerequisites map
      methodRepoMethod:
        type: Map
        description: Method ID
    required:
      - namespace
      - name
      - rootEntityType
      - inputs
      - outputs
      - prerequisites
      - methodRepoMethod
  PublishConfigurationIngest:
    properties:
      configurationNamespace:
        type: string
        description: Method configuration namespace
      configurationName:
        type: string
        description: Method configuration name
      sourceNamespace:
        type: string
        description: Method configuration source namespace
      sourceName:
        type: string
        description: Method configuration source name
    required:
      - configurationNamespace
      - configurationName
      - sourceNamespace
      - sourceName
  AttributeUpdateOperation:
    properties:
      op:
        type: string
        description: Operation to perform on the attribute
      attributeName:
        type: string
        description: The name of the attribute
      addUpdateAttribute:
        type: string
        description: The value of the attribute (if adding/updating)
    required:
      - op
      - attributeName
  CopyEntity:
    properties:
      sourceWorkspace:
        schema:
          $ref: '#/definitions/Namespace'
        description: Source Workspace Namespace
      entityType:
        type: string
        description: Entity Type
      entityNames:
        type: array
        items:
          type: string
        description: List of entity names to be copied
  Namespace:
    properties:
      namespace:
        type: string
        description: Entity namespace
      name:
        type: string
        description: Entity name
  DeleteEntities:
    properties:
      recursive:
        type: boolean
        default: false
        description: Whether or not to recursively delete (currently unimplemented)
      entities:
        type: array
        items:
          $ref: '#/definitions/EntityID'
        description: List of entities to be deleted
    required:
      - recursive
      - entities
  EntityID:
    properties:
      entityType:
        type: string
        description: Entity Type
      entityName:
        type: string
        description: Entity Name
  Entity:
    description: ''
    required:
      - name
      - entityType
      - attributes
    properties:
      name:
        type: string
        description: The name of the entity
      entityType:
        type: string
        description: The type of the entity
      attributes:
        type: ''
        description: Map[String,Attribute]
  EntityQueryParameters:
    description: ''
    required:
      - page
      - pageSize
      - sortField
      - sortDirection
    properties:
      page:
        type: number
        description: page number, 1-indexed positive integer
      pageSize:
        type: number
        description: count of items per page, positive integer
      sortField:
        type: string
        description: field to sort by
      sortDirection:
        type: string
        description: asc or desc
      filterTerms:
        type: string
        descriptions: terms to filter results by
  EntityQueryResultMetadata:
    description: ''
    required:
      - unfilteredCount
      - filteredCount
      - filteredPageCount
    properties:
      unfilteredCount:
        type: number
        description: count of results before filtering
      filteredCount:
        type: number
        description: count of results after filtering
      filteredPageCount:
        type: number
        description: count of pages after filtering; honors pageSize parameter
  EntityQueryResponse:
    description: ''
    required:
      - parameters
      - resultMetadata
      - results
    properties:
      parameters:
        $ref: '#/definitions/EntityQueryParameters'
      resultMetadata:
        $ref: '#/definitions/EntityQueryResultMetadata'
      results:
        type: array
        items:
          $ref: '#/definitions/Entity'
  MethodID:
    properties:
      methodNamespace:
        type: string
        description: Method namespace
      methodName:
        type: string
        description: Method name
      methodVersion:
        type: int
        default: 0
        description: Method version
    required:
      - methodNamespace
      - methodName
      - methodVersion
  MethodConfiguration:
    description: ''
    required:
      - namespace
      - name
      - rootEntityType
      - inputs
      - methodRepoMethod
    properties:
      namespace:
        type: string
        description: 'This method configuration''s namespace'
      name:
        type: string
        description: The name of the method configuration
      rootEntityType:
        type: string
        description: The root entity type that the method will be running on
      prerequisites:
        $ref: ''
      inputs:
        $ref: ''
      outputs:
        $ref: ''
      methodRepoMethod:
        $ref: '#/definitions/MethodRepoMethod'
        description: The properties of the method from the method store that this config is associated with
  ValidatedMethodConfiguration:
    description: ''
    required:
      -methodConfiguration
      -validInputs
      -invalidInputs
      -validOutputs
      -invalidOutputs
    properties:
      validInputs:
        type: array
        items:
          type: string
      invalidInputs:
        $ref: ''
      validOutputs:
        type: array
        items:
          type: string
      invalidOutputs:
        $ref: ''
      methodConfiguration:
        $ref: '#/definitions/MethodConfiguration'
  Profile:
    properties:
      name:
        type: string
        description: User's full name
      email:
        type: string
        description: User's email address
      institution:
        type: string
        description: User's home institution
      pi:
        type: string
        description: Primary Investigator
  JWTWrapper:
    properties:
      jwt:
        type: string
        description: the encoded/signed JWT
  NIHStatus:
    required:
      - loginRequired
      - linkedNihUsername
    properties:
      loginRequired:
        type: boolean
      linkedNihUsername:
        type: string
      isDbgapAuthorized:
        type: boolean
      lastLinkTime:
        type: long
        format: int64
        default: 0
      linkExpireTime:
        type: long
        format: int64
        default: 0
      secondsSinceLastLink:
        type: long
        format: int64
        default: 0
      descriptionSinceLastLink:
        type: string
  Enabled:
    properties:
      google:
        type: boolean
        description: User enabled via Google?
      ldap:
        type: boolean
        description: User enabled in LDAP?
      allUsersGroup:
        type: boolean
        description: User is a member of the "All Users" group?
  UserInfo:
    properties:
      userSubjectId:
        type: string
        description: Subject ID (from Google)
      userEmail:
        type: string
        description: User's email
  Me:
    properties:
      userInfo:
        $ref: '#/definitions/UserInfo'
      enabled:
        $ref: '#/definitions/Enabled'
  ExtendedEnabled:
    allOf:
      - $ref: '#/definitions/Enabled'
    properties:
      allUsersGroup:
        type: boolean
        description: User is a member of the "All Users" group?
  RawlsMe:
    properties:
      userInfo:
        $ref: '#/definitions/UserInfo'
      enabled:
        $ref: '#/definitions/ExtendedEnabled'
  BillingAccountRedirect:
    description: 'Google redirect URL to enable appropriate scopes'
    required:
      - redirect
    properties:
      redirect:
        type: string
        description: URL to redirect to
  BillingAccount:
    description: 'Details for a single billing account'
    required:
      - accountName
      - firecloudHasAccess
      - displayName
    properties:
      accountName:
        type: string
        description: name of billing account
      firecloudHasAccess:
        type: boolean
        description: whether the Firecloud service has been given access to this billing account
      displayName:
        type: string
        description: display name of billing account
  BillingProjectMembership:
    description: ''
    required:
      - projectName
      - role
    properties:
      projectName:
        type: string
        description: the name of the project to create
      role:
        type: string
        description: the role of the current user in the project
  BillingProjectMember:
    description: ''
    required:
      - email
      - role
    properties:
      email:
        type: string
        description: the email of the user
      role:
        type: string
        description: the role of the user in the project
  CreateRawlsBillingProjectFullRequest:
    description: ''
    required:
      - projectName
      - BillingAccount
    properties:
      projectName:
        type: string
        description: the name of the project to create
      billingAccount:
        type: string
        description: the id of the billing account to use, must start with 'billingAccounts/'

  ErrorReport:
    description: ''
    required:
      - source
      - message
      - causes
      - stackTrace
    properties:
      source:
        type: string
        description: service causing error
      message:
        type: string
        description: what went wrong
      statusCode:
        type: integer
        description: HTTP status code
      causes:
        type: array
        description: errors triggering this one
        items:
          $ref: '#/definitions/ErrorReport'
      stackTrace:
        type: array
        description: stack trace
        items:
          $ref: '#/definitions/StackTraceElement'

  StackTraceElement:
    description: ''
    required:
      - className
      - methodName
      - fileName
      - lineNumber
    properties:
      className:
        type: string
        description: class name
      methodName:
        type: string
        description: method name
      fileName:
        type: string
        description: source file name
      lineNumber:
        type: integer
        description: line number

  Workspace:
    description: ''
    required:
      - namespace
      - name
      - workspaceId
      - bucketName
      - createdDate
      - createdBy
      - attributes
      - accessLevels
    properties:
      namespace:
        type: string
        description: The namespace the workspace belongs to
      name:
        type: string
        description: The name of the workspace
      realm:
        $ref: '#/definitions/RawlsGroupRef'
        description: An optional realm for the workspace
      workspaceId:
        type: string
        description: A UUID associated with the workspace
      bucketName:
        type: string
        description: The name of the bucket associated with the workspace
      createdDate:
        type: string
        format: date-time
        description: 'The date the workspace was created in yyyy-MM-ddTHH:mm:ss.SSSZZ format'
      lastModified:
        type: string
        format: date-time
        description: 'The date the workspace was last modified in yyyy-MM-ddTHH:mm:ss.SSSZZ format'
      createdBy:
        type: string
        description: The user who created the workspace
      attributes:
        $ref: ''
        description: Map[String, Attribute]
      accessLevels:
         $ref: ''
         description: Map[String, RawlsGroupRef]
      realmACLs:
         $ref: ''
         description: Map[String, RawlsGroupRef]
      isLocked:
        type: boolean
        description: Can the Workspace currently be modified?
  RawlsGroupRef:
    description: a reference to a group
    properties:
      groupName:
        type: string
        description: ''

